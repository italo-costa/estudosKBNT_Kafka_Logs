# =============================================================================
# KBNT Environment Startup Configuration
# Technical Configuration File for Service Orchestration
# =============================================================================

# Service Timing Configuration (in seconds)
KAFKA_READY_TIMEOUT=120
POSTGRESQL_READY_TIMEOUT=60  
PRODUCER_SERVICE_TIMEOUT=90
CONSUMER_SERVICE_TIMEOUT=90
HEALTH_CHECK_TIMEOUT=60
WORKFLOW_TEST_TIMEOUT=60

# Service Dependencies and Startup Order
STARTUP_PHASES=(
    "prerequisites:30"
    "namespace:10"
    "postgresql:60"
    "kafka:120"
    "topics:30"
    "producer:90"
    "consumer:90"
    "health:60"
    "test:60"
)

# Environment Settings
NAMESPACE=kbnt-system
ENVIRONMENT=production

# Resource Allocation
KAFKA_BROKERS=3
POSTGRESQL_REPLICAS=1
PRODUCER_REPLICAS=2
CONSUMER_REPLICAS=3

# Topic Configuration
TOPICS=(
    "stock-updates:3:3"
    "high-priority-stock-updates:3:3"
    "stock-updates-retry:3:3"
    "stock-updates-dlt:1:3"
    "publication-logs:3:3"
)

# Health Check Endpoints
PRODUCER_HEALTH_URL="http://localhost:8080/actuator/health"
CONSUMER_HEALTH_URL="http://localhost:8081/api/consumer/actuator/health"
POSTGRESQL_HEALTH_CMD="kubectl exec -n ${NAMESPACE} deployment/kbnt-postgresql -- pg_isready -U kbnt_user -d kbnt_consumption_db"

# Port Forwarding Configuration
PRODUCER_LOCAL_PORT=8080
CONSUMER_LOCAL_PORT=8081
POSTGRESQL_LOCAL_PORT=5432
KAFKA_LOCAL_PORT=9092

# Service Names and Labels
POSTGRESQL_SERVICE=kbnt-postgresql
KAFKA_SERVICE=kbnt-kafka-cluster-kafka-bootstrap
PRODUCER_SERVICE=kbnt-stock-producer-service
CONSUMER_SERVICE=kbnt-stock-consumer-service

# Monitoring Configuration
METRICS_ENABLED=true
PROMETHEUS_ENABLED=true
DETAILED_LOGGING=true

# Development vs Production Overrides
[development]
KAFKA_BROKERS=1
PRODUCER_REPLICAS=1
CONSUMER_REPLICAS=1
POSTGRESQL_READY_TIMEOUT=30
KAFKA_READY_TIMEOUT=60

[production]
KAFKA_BROKERS=3
PRODUCER_REPLICAS=2
CONSUMER_REPLICAS=3
POSTGRESQL_READY_TIMEOUT=60
KAFKA_READY_TIMEOUT=120

# Retry Configuration
MAX_RETRIES=5
RETRY_DELAY=10
EXPONENTIAL_BACKOFF=true

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE_ENABLED=true
LOG_FILE_PATH="/tmp/kbnt-startup.log"
COLORED_OUTPUT=true

# External Dependencies
EXTERNAL_API_ENABLED=false
EXTERNAL_API_URL="https://httpbin.org/delay/2"
MOCK_EXTERNAL_API=true
